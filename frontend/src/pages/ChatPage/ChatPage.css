/* ===== Tokens ===== */
:root{
  --border:#e9ecef; --ink:#212529; --muted:#6c757d; --bg:#fff; --panel:#f8f9fa;
  --brand:#007bff; --ok:#28a745; --bubble-in:#ffffff; --bubble-out:#dcf8c6;
}

/* ===== Shell da página (header + main) ===== */
html, body { height: 100%; }
.content-wrapper{
  min-height: 100vh;
  min-height: 100svh;      /* iOS/Android toolbars dinâmicas */
  min-height: 100dvh;
  display: flex;
  flex-direction: column;
}
.main-header{ flex: 0 0 auto; }
.main-content{
  flex: 1 1 auto;
  min-height: 0;           /* crítico p/ scroll interno funcionar */
  overflow: hidden;        /* zera scroll do body */
  padding-bottom: env(safe-area-inset-bottom);
}

/* ===== Contêiner raiz do chat ===== */
.admin-page.chat-page{
  display:flex;
  height: 100%;            /* ocupa 100% do main-content */
  min-height: 0;
  background-color: var(--bg);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,.08);
  overflow:hidden;         /* sem scroll fora das colunas */
}

/* Hardening: permite scroll interno em layouts flex */
.admin-page.chat-page,
.conversations-list,
.chat-window,
.messages-area { min-height:0; min-width:0; }

/* ===== Coluna Esquerda: Lista de Conversas ===== */
.conversations-list{
  width:340px;                      /* ajuste: 320/360 se quiser */
  border-right:1px solid var(--border);
  display:flex; flex-direction:column;
  flex-shrink:0;
  background-color: var(--panel);
  height:100%;
  overflow:hidden;                  /* scroll fica no UL */
}
.conversations-list header{
  padding:12px 16px;
  border-bottom:1px solid var(--border);
  background:var(--panel);
  position:sticky; top:0; z-index:1;
}
.conversations-list h3{ margin:0; font-size:1.1rem; color:var(--ink); }
.conversations-list ul{
  list-style:none; margin:0; padding:0;
  flex:1 1 auto; height:100%;
  overflow-y:auto; -webkit-overflow-scrolling:touch;
}
.conversations-list li{
  display:flex; align-items:center; gap:12px;
  padding:12px 15px;
  border-bottom:1px solid var(--border);
  cursor:pointer; transition: background-color .2s;
  position:relative; background:#fff;
}
.conversations-list li:hover{ background-color:#f2f4f7; }
.conversations-list li.active{ background-color: var(--brand); color:#fff; }
.conversations-list li.active .conv-name{ color:#fff; }
.conversations-list li.active .conv-preview{ color:#f0f0f0; }
.conv-avatar{ width:48px;height:48px;border-radius:50%;object-fit:cover;background:#ddd; flex:0 0 auto; }
.conv-info{ overflow:hidden; }
.conv-name{ font-weight:600; display:block; margin:0 0 4px; color:#343a40; }
.conv-preview{
  font-size:.9em; color:var(--muted);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; display:block;
  max-width:220px;
}
.unread-badge{
  position:absolute; top:50%; right:15px; transform:translateY(-50%);
  background:var(--ok); color:#fff; font-size:.75em; font-weight:700;
  padding:4px 8px; border-radius:12px;
}

/* ===== Coluna Direita: Janela do Chat ===== */
.chat-window{
  flex:1 1 auto; display:flex; flex-direction:column;
  background-color:#e5ddd5; height:100%;
}
.chat-header{
  display:flex; align-items:center; gap:15px;
  padding:10px 15px; border-bottom:1px solid #e0e0e0;
  background:#f0f2f5; flex:0 0 auto;
}
.chat-avatar{ width:40px;height:40px;border-radius:50%;object-fit:cover;background:#ccc; }
.chat-header-info h4{ margin:0; font-size:1.1em; color:#111; }
.chat-header-info span{ font-size:.8em; color:var(--muted); }
.chat-header-actions{ margin-left:auto; }

/* Botão voltar (mobile) */
.back-button{
  display:none; background:var(--brand); color:#fff; border:none;
  padding:6px 12px; border-radius:6px; font-size:.9rem; cursor:pointer;
}

/* Área de mensagens (scroll central) */
.messages-area{
  flex:1 1 auto; overflow-y:auto; -webkit-overflow-scrolling:touch;
  padding:16px; background:#e5ddd5;
  display:flex; flex-direction:column; gap:10px;
  font-size:.95rem; line-height:1.25; word-break:break-word; overflow-x:hidden;
}

/* Dica de carregar histórico */
.load-older-hint{
  text-align:center; font-size:.85rem; color:var(--muted); padding:6px 0;
}

/* Bolhas */
.message-bubble-wrapper{ display:flex; max-width:80%; }
@media (max-width:480px){ .message-bubble-wrapper{ max-width:88%; } }
.message-bubble-wrapper.incoming{ justify-content:flex-start; align-self:flex-start; }
.message-bubble-wrapper.outgoing{ justify-content:flex-end; align-self:flex-end; }
.message-bubble{
  background:#fff; color:#212529;
  border-radius:16px; padding:8px 12px;
  box-shadow:0 1px 1px rgba(0,0,0,.05);
}
.message-bubble p{ margin:0; }
.message-timestamp{ display:block; font-size:.75em; margin-top:5px; text-align:right; opacity:.7; }

/* Cores WhatsApp-like */
.message-bubble-wrapper.incoming .message-bubble{ background: var(--bubble-in); border-bottom-left-radius:4px; }
.message-bubble-wrapper.outgoing .message-bubble{ background: var(--bubble-out); border-bottom-right-radius:4px; }
.message-bubble-wrapper.outgoing .message-bubble .message-timestamp{ color:#557549; }

/* Tipos de conteúdo */
.message-image{ max-width:100%; border-radius:8px; cursor:pointer; }
.message-caption{ margin-top:8px; font-size:.9em; color:#333; }
.message-audio{ width:100%; min-width:250px; }
.message-document{
  display:flex; align-items:center; gap:10px; padding:10px;
  background:rgba(0,0,0,.05); border-radius:8px; text-decoration:none; color:#333;
}
.message-document:hover{ background:rgba(0,0,0,.1); }

/* Input de mensagem */
.message-input-area{
  display:flex; align-items:center; gap:10px;
  padding:10px 15px; border-top:1px solid #e0e0e0; background:#f0f2f5; flex:0 0 auto;
  padding-bottom: calc(10px + env(safe-area-inset-bottom)); /* notches */
}
.message-input-area input{
  flex:1 1 auto; border:1px solid #ccc; padding:12px 18px;
  border-radius:22px; font-size:1em; background:#fff;
}
.message-input-area button{ border-radius:50%; width:44px; height:44px; padding:0; cursor:pointer; }

/* Estado sem conversa selecionada */
.no-chat-selected{
  display:flex; align-items:center; justify-content:center;
  height:100%; color:var(--muted); font-size:1.2em; background:#f8f9fa;
}

/* ===== Mobile: alternância lista/chat e 100% de altura ===== */
@media (max-width:768px){
  .admin-page.chat-page{ flex-direction:column; }

  .conversations-list{ display:none; }
  .chat-window{ display:none; }

  .chat-page.view-list .conversations-list{ display:flex; height:100%; }
  .chat-page.view-chat  .chat-window{      display:flex; height:100%; }

  .back-button{ display:inline-block; }
}

/* ===== Extras ===== */
.load-more-hint{ text-align:center; font-size:.85rem; color:var(--muted); padding:8px 0; }
